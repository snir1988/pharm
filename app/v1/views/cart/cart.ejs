<%- include('../partials/header') %> <!-- ✅ כולל את קובץ ההדר (HTML פתיחה, title, link וכו') -->
<link rel="stylesheet" href="/styles/global.css" /> <!-- ✅ עיצוב כללי של האתר -->
<link rel="stylesheet" href="/styles/cart.css" /> <!-- ✅ עיצוב ייעודי לעמוד העגלה -->

<section class="cart-page"> <!-- ✅ אזור ראשי לעמוד העגלה -->
  <h2 class="cart-title">העגלה שלך</h2> <!-- ✅ כותרת ראשית של הדף -->

  <% if (cart.length === 0) { %> <!-- ✅ בדיקה האם העגלה ריקה -->
    <p class="empty-cart">העגלה ריקה</p> <!-- ✅ הודעה אם אין מוצרים בעגלה -->
  <% } else { %>
    <div class="cart-grid"> <!-- ✅ גריד של כרטיסים לכל מוצר -->
      <% cart.forEach(item => { %> <!-- ✅ מעבר על כל פריט בעגלה -->
        <div class="cart-card"> <!-- ✅ כרטיס מוצר בודד -->

          <!-- ✅ הצגת תמונת המוצר -->
          <img
            src="<%= item.picname ? '/images/' + item.picname : '/images/default.jpg' %>" <!-- אם אין תמונה -> תצוגת ברירת מחדל -->
            alt="<%= item.pname %>" <!-- טקסט אלטרנטיבי -->
          />

          <div class="cart-details"> <!-- ✅ פרטי המוצר -->
            <h3><%= item.pname %></h3> <!-- ✅ שם המוצר -->
            <p>מחיר ליחידה: ₪<%= item.price %></p> <!-- ✅ מחיר של יחידה אחת -->

            <!-- ✅ קלט לשינוי כמות -->
            <label>כמות:</label>
            <input
              type="number"
              class="quantity-input"
              data-product-id="<%= item.pid %>" <!-- מזהה ייחודי למוצר -->
              value="<%= item.qty %>" <!-- כמות נוכחית -->
              min="1"
            />

            <p class="line-total">סה"כ: ₪<%= item.total %></p> <!-- ✅ סה"כ לשורה (מחיר כפול כמות) -->

            <!-- ✅ כפתור להסרה מהעגלה -->
